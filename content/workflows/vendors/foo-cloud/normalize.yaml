schema: 1
type: normalize

vendor-id: foo-cloud
id: foo-cloud-normalize

filters:
  - match-type: all
    rules:
      - .badThingJustHappened and .badThingJustHappened.description
      - .badThingJustHappened.description | contains ("fubar")

output:
  - name: vendorId
    value: foo-cloud
    value-type: STRING
  - name: alertId
    value: demo-alert-id
    value-type: STRING
  - name: canonicalId
    value: demo-canonicalId
    value-type: STRING
  - name: vendorPolicy
    value: dempo-vendorPolicy
    value-type: STRING
  - name: csp
    value: demo-csp
    value-type: STRING
  - name: resourceContainer
    value: demo-resourceContainer
    value-type: STRING
  - name: region
    value: demo-region
    value-type: STRING
  - name: service
    value: demo-service
    value-type: STRING
  - name: resourceType
    value: demo-resourceType
    value-type: STRING
  - name: resourceId
    value: demo-resoureceId
    value-type: STRING

output-queue:
  enabled: true
