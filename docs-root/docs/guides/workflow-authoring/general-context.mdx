# General Context

The `general-context` workflow allows helps you answer the questions "how important is this resource and what has it been up to lately?"

## Example

Say, for example, you wanted to differentiate between dev and prod resources. You can write rules to assign critical risk for prod assets and low risk for dev assets. Let's take a look at an example:

```yaml title="content/workflows/csp/aws/general-context/general-context.yaml"
schema: 1
type: general-context

id: general-context-aws
name: General context + tag-based risk for AWS resources

csp: aws

filters:
    - match-type: all
      rules:
          - .csp=="aws" and .canonicalId and .resourceType != "AwsAccount" # for alerts belonging to an account, the resource type is set to "AwsAccount" by security hub
          #todo: try to get tags from aws org for the account

steps:
    - id: getTags
      uses: GetTags
      with:
          - name: arn
            value: .canonicalId
          - name: region
            value: .region

risk-config:
    default-risk: ''
    rules:
        - name: dev enviornment risk is low
          condition: |-
              .getTags | any( select(.key | test("env" ; "ix")) | select(.value | test("dev" ; "ix")))
          risk: low

        - name: prod enviornment risk is high
          condition: |-
              .getTags | any( select(.key | test("env" ; "ix")) | select(.value | test("prod" ; "ix")))
          risk: high

output:
    - name: environment
      value: first(.getTags[] | select(.key == "env") .value)
```

## Reference

Following is the reference for all the available fields.

import Schema from '../../common-fields/schema.md'
import Id from '../../common-fields/workflows/workflow-id.md'
import Name from '../../common-fields/name.md'
import Labels from '../../common-fields/labels.md'
import Filters from '../../common-fields/workflows/filters.md'
import MatchType from '../../common-fields/workflows/match-type.md'
import RuleSyntax from '../../common-fields/workflows/rule-syntax.md'
import RiskConfig from '../../common-fields/workflows/risk-config.mdx'
import Steps from '../../common-fields/workflows/steps.mdx'
import Output from '../../common-fields/workflows/output.md'

### `schema`

<Schema />

### `type`

Always `general-context` for this kind of workflow.

### `id`

<Id />

### `name`

<Name />

### `labels`

<Labels />

### `csp`

Cloud service provider. A list of all supported cloud service providers can be found [here](https://github.com/dassana-io/dassana/blob/main/content/schemas/resource-hierarchy/resource-hierarchy.yaml).

### `filters`

<Filters />

#### `match-type`

<MatchType />

#### `rules`

<RuleSyntax />

### `steps`

<Steps />

### `risk-config`

<RiskConfig />

### `output`

<Output />
